#!/bin/sh

export htslib="htslib";
export lmdb="lmdb/libraries/liblmdb";
export sqlite3="sqlite3";
export bamdb="bamdb";

echo "Copying fPIC Makefile into $htslib/Makefile";
cp Makefile.htslib.fPIC $htslib/Makefile;

rm src/Rbamdb.so


echo "entering htslib directory and compiling...";
cd $htslib;
#make clean
#autoheader;
#autoconf;
#./configure;
make;
echo "leaving ${htslib} directory";
cd ..;

echo "the current working directory is" $(pwd);

echo "entering lmdb directory and compiling...";
cd $lmdb;
make;
echo "leaving ${lmdb} diretory";
cd ../../../;

echo "the current working directory is" $(pwd);

echo "entering sqlite directory and compiling...";
cd $sqlite3;
make;
ar sr libsqlite3.a sqlite3.o sqlite3-shell.o sqlite3-sqlite3.o
echo "leaving ${sqlite3} directory";
cd ..;

echo "the current working directory is" $(pwd);

echo "entering bamdb directory and compiling...";
cd $bamdb;
make clean;
make;
##echo "chmodddddddddddddddddddding"
##chmod 777 bin/libbamdb.a
echo "leaving ${bamdb} directory";
cd ..

echo "the current working directory is" $(pwd);

rm -f ./$htslib/libhts.so
rm -f ./$htslib/libhts.so.2

rm -f ./$lmdb/liblmdb.so

rm -f ./$sqlite3/libsqlite3.so

#echo "copppppppyyyyyyyyyyyying"
#cp ./bamdb/bin/libbamdb.a ./
