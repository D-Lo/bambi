#!/bin/sh

export htslib="htslib";
export lmdb="lmdb/libraries/liblmdb";
export bamdb="bamdb";
export ck="ck";

echo "Copying fPIC Makefile into $htslib/Makefile";
cp Makefile.htslib.fPIC $htslib/Makefile;

rm src/Rbamdb.so

echo "entering htslib directory and compiling...";
cd $htslib;
#make clean
#autoheader;
#autoconf;
#./configure;
make;
echo "leaving ${htslib} directory";
cd ..;

echo "the current working directory is" $(pwd);

echo "entering lmdb directory and compiling...";
cd $lmdb;
make;
echo "leaving ${lmdb} diretory";
cd ../../../;

echo "the current working directory is" $(pwd);

echo "entering ck directory and compiling...";
cd $ck;
make clean;
./configure;
make;
echo "leaving ${ck} directory";
cd ..;

echo "the current working directory is" $(pwd);

echo "entering bamdb directory and compiling...";
cd $bamdb;
make clean;
make;
##chmod 777 bin/libbamdb.a
echo "leaving ${bamdb} directory";
cd ..

echo "the current working directory is" $(pwd);

rm -f ./$htslib/libhts.so
rm -f ./$htslib/libhts.so.2
rm -f ./$lmdb/liblmdb.so
rm -f ./$ck/src/libck.so
rm -f ./$bamdb/bamdb.a

#echo "copppppppyyyyyyyyyyyying"
#cp ./bamdb/bin/libbamdb.a ./
